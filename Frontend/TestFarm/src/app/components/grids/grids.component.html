<div>
  <div class="breadcrumb-island">
    <nav class="breadcrumb">
      <div class="breadcrumb-item">
        <a href="#">TestFarm</a>
      </div>
      <svg xmlns="http://www.w3.org/2000/svg" class="breadcrumb-separator" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
      </svg>
      <div class="breadcrumb-item active">
        Grids
      </div>
    </nav>
  </div>
  <div class="islands-grid">
    <div class="island island-large">
      <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap; align-items: center;">
        <div style="flex: 1; min-width: 200px;">
          <input type="text" id="dataSearch" placeholder="Search grids or hosts..."
            [(ngModel)]="searchTerm"
            (input)="onSearchChange($event)"
            style="width: 100%; padding: 0.75rem; border: 1px solid #e9ecef; border-radius: 8px; background: linear-gradient(315deg, #f8f9fa 0%, #ffffff 100%); font-size: 0.875rem; transition: all 0.2s ease;">
        </div>
      </div>
      <div style="overflow-x: auto; background: linear-gradient(315deg, #f8f9fa 0%, #ffffff 100%); border-radius: 8px; border: 1px solid #e9ecef;">
        <table id="gridsTable" style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="background: linear-gradient(315deg, #f0f1f2 0%, #ffffff 100%); border-bottom: 2px solid #e9ecef; font-size: small;">
              <th class="column fit-content">
              </th>
              <th class="column-sortable fit-content" data-sort="id" (click)="sortTable('id')">
                Id
                <svg style="width: 12px; height: 12px; display: inline-block; margin-left: 0.5rem; opacity: 0.5;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                </svg>
              </th>
              <th class="column-sortable" data-sort="name" style="text-align: center;" (click)="sortTable('name')">
                Name
                <svg style="width: 12px; height: 12px; display: inline-block; margin-left: 0.5rem; opacity: 0.5;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                </svg>
              </th>
              <th class="column" style="text-align: center;">
                Status
              </th>
              <th class="column-sortable fit-content" data-sort="hosts" style="text-align: center;" (click)="sortTable('hosts')">
                Hosts
                <svg style="width: 12px; height: 12px; display: inline-block; margin-left: 0.5rem; opacity: 0.5;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                </svg>
              </th>
              <th class="column-sortable" data-sort="created" style="text-align: center;" (click)="sortTable('created')">
                Created
                <svg style="width: 12px; height: 12px; display: inline-block; margin-left: 0.5rem; opacity: 0.5;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                </svg>
              </th>
              <th class="column-sortable" data-sort="updated" style="text-align: center;" (click)="sortTable('updated')">
                Last Update
                <svg style="width: 12px; height: 12px; display: inline-block; margin-left: 0.5rem; opacity: 0.5;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                </svg>
              </th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let row of filteredGridsRows">
              <!-- Grid Row -->
              <tr class="grid-row" style="border-bottom: 1px solid #f5f5f5; transition: all 0.3s ease;">
                <td class="cell">
                  <button class="expand-btn" (click)="toggleExpand(row, $event)" [class.expanded]="row.expanded">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                  </button>
                </td>
                <td class="cell">
                  {{row.grid.Id}}
                </td>
                <td class="cell">
                  <div style="display: flex; gap: 5px; justify-content: center; align-items: center;">
                    <span class="grid-name">{{row.grid.Name}}</span>
                  </div>
                </td>
                <td class="cell">
                  <div style="display: flex; gap: 5px; justify-content: center; align-items: center;">
                    <span class="grid-status status-{{ getGridStatus(row.grid) }}">{{ getGridStatus(row.grid) }}</span>
                  </div>
                </td>
                <td class="cell">
                  <span class="host-count">{{row.grid.Hosts.length}}</span>
                </td>
                <td class="cell">
                  <div style="display: flex; gap: 5px; justify-content: center; align-items: center;">
                    {{ row.grid.CreationTimestamp | date:'dd/MM/yyyy HH:mm' }}
                  </div>
                </td>
                <td class="cell">
                  <div style="display: flex; gap: 5px; justify-content: center; align-items: center;">
                    {{ row.grid.LastUpdateTimestamp | date:'dd/MM/yyyy HH:mm' }}
                  </div>
                </td>
              </tr>
              <!-- Hosts Sub-table Row -->
              <tr *ngIf="row.expanded" class="hosts-row">
                <td colspan="7" style="padding: 0;">
                  <div class="hosts-container">
                    <table class="hosts-table">
                      <thead>
                        <tr>
                          <th>Hostname</th>
                          <th>Type</th>
                          <th>Status</th>
                          <th>Cores</th>
                          <th>RAM</th>
                          <th>Created</th>
                          <th>Last Update</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let host of row.grid.Hosts" [ngClass]="{'host-online': getHostStatus(host) === 'online', 'host-offline': getHostStatus(host) === 'offline'}">
                          <td>{{host.Hostname}}</td>
                          <td>{{host.Type}}</td>
                          <td>
                            <span class="host-status status-{{ getHostStatus(host) }}">{{ host.Status }}</span>
                          </td>
                          <td>{{host.Cores}}</td>
                          <td>{{host.RAM}} GB</td>
                          <td>{{ host.CreationTimestamp | date:'dd/MM/yyyy HH:mm' }}</td>
                          <td>{{ host.LastUpdateTimestamp | date:'dd/MM/yyyy HH:mm' }}</td>
                        </tr>
                      </tbody>
                    </table>
                    <div *ngIf="row.grid.Hosts.length === 0" class="no-hosts">
                      No hosts registered in this grid
                    </div>
                  </div>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
      <div id="noResults" *ngIf="filteredGridsRows.length === 0" style="text-align: center; padding: 2rem; color: #6c757d;">
        <svg style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.467.881-6.077 2.33l-.853-.894A9.96 9.96 0 0112 13.5a9.96 9.96 0 016.93 2.936l-.853.894z"></path>
        </svg>
        <div>{{ searchTerm ? 'No grids match your search criteria' : 'No grids found' }}</div>
      </div>
    </div>
  </div>
</div>
